<!DOCTYPE html>
<html>
  <head>
    <script src="js/env.js"></script>
    <script lang="javascript" src="js/jquery-3.1.0.min.js"></script>
    <script lang="javascript" src="js/d3.v4.min.js"></script>
    <script lang="javascript" src="js/data.js"></script>
    <script type="text/application/javascript/json" src="js/jquery.ajax-cross-origin.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
  </head>
  <body>
    
    <div>
      
	<svg width=100% height=100%></svg> 
	<script>
	 
	 var svg = d3.select("svg")
		     .attr('width',1000)//parseFloat(svg.style("width")),
		     .attr('height',750); //parseFloat(svg.style("height")),
	 
	 var g = svg.append("g");


	 var d = $.ajax({
	     crossOrigin: true,
	     url: env.ngrok_ip + '/welcome',
	     type: "POST",
	     data: 'name=Donald Trump',				
	     success: function(returned_data) {
		 json_data = JSON.parse(returned_data);
		 sorted_keys = Object.keys(json_data).sort();
		 console.log(sorted_keys);
		 console.log(json_data[sorted_keys[0]]);
		 console.log(sorted_keys.length);
		 ivals = [Array(sorted_keys.length).keys()];
		 console.log(ivals);
		 var x_offset=25;
		 for (i=0; i<sorted_keys.length; i++) {
		     console.log(i);
		     var x_val = i*50+x_offset;
		     var key = sorted_keys[i];
		     g.append('circle')
		      .attr("r", json_data[key]['positive'] * 50)
		      .attr("cx",x_val)
		      .attr("cy",75)
		      .style("fill","green");

		     g.append('circle')
		      .attr("r", json_data[key]['negative'] * 50 * -1)
		      .attr("cx",x_val)
		      .attr("cy",160)
		      .style("fill","red");

		     g.append('text')
		      .attr('x',x_val)
		      .attr('y',125)
		      .text(key)
		      .style('text-anchor','middle');		     		     		   
		 };
	     }
	 });	       
	 
	</script>
    </div>
</body>
